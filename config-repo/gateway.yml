server.port: 8086

spring:
    security.oauth2.resourceserver.jwt:
        jwk-set-uri: http://keycloak:8080/realms/${app.auth-server-realm}/protocol/openid-connect/certs

logging:
    level:
        org.springframework.cloud.gateway: trace
        org.springframework.cloud.gateway.route.RouteDefinitionRouteLocator: info

spring.cloud.gateway.routes:
    - id: inventory
      uri: lb://inventory
      predicates:
          - Path=/v1/inventory/**
      filters:
          - RewritePath=/v1/inventory/(?<segment>.*), /v1/${segment}

    - id: inventory-swagger-ui
      uri: lb://inventory
      predicates:
          - Path=/v1/openapi/inventory/**

    - id: eureka-api
      uri: http://${app.eureka-server}
      predicates:
          - Path=/eureka/api/{segment}
      filters:
          - SetPath=/eureka/{segment}

    - id: eureka-web
      uri: http://${app.eureka-server}
      predicates:
          - Path=/eureka/web
      filters:
          - SetPath=/

    - id: eureka-web-other
      uri: http://${app.eureka-server}
      predicates:
          - Path=/eureka/**

    - id: config-server
      uri: ${spring.cloud.config.uri}
      predicates:
          - Path=/config/**
      filters:
          - RewritePath=/config/(?<segment>.*), /$\{segment}

    - id: auth-server
      uri: http://${app.auth-server-base}
      predicates:
          - Path=/realms/**

---
spring.config.activate.on-profile: dev

server.port: 8080